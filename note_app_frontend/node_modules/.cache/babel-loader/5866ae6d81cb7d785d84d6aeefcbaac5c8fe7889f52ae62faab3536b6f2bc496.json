{"ast":null,"code":"import axios from 'axios';\nconst axiosInstance = axios.create({\n  baseURL: 'http://localhost:8000/api/',\n  timeout: 5000\n});\naxiosInstance.interceptors.request.use(config => {\n  const accessToken = localStorage.getItem('access_token');\n  if (accessToken) {\n    config.headers['Authorization'] = 'Bearer ' + accessToken;\n  }\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\naxiosInstance.interceptors.response.use(response => response, async error => {\n  const originalRequest = error.config;\n  if (error.response.status === 401 && originalRequest.url === 'token/refresh/') {\n    window.location.href = '/login';\n    return Promise.reject(error);\n  }\n  if (error.response.status === 401 && !originalRequest._retry) {\n    originalRequest._retry = true;\n    const refreshToken = localStorage.getItem('refresh_token');\n    if (refreshToken) {\n      try {\n        const response = await axios.post('http://localhost:8000/api/token/refresh/', {\n          refresh: refreshToken\n        });\n        localStorage.setItem('access_token', response.data.access);\n        axios.defaults.headers['Authorization'] = 'Bearer ' + response.data.access;\n        return axiosInstance(originalRequest);\n      } catch (err) {\n        console.error(\"Token refresh failed\", err);\n        window.location.href = '/login';\n      }\n    }\n  }\n  return Promise.reject(error);\n});\nexport default axiosInstance;","map":{"version":3,"names":["axios","axiosInstance","create","baseURL","timeout","interceptors","request","use","config","accessToken","localStorage","getItem","headers","error","Promise","reject","response","originalRequest","status","url","window","location","href","_retry","refreshToken","post","refresh","setItem","data","access","defaults","err","console"],"sources":["/Users/mtiatnuclieos/projects/assessments/dental_bee_assessment/note_app_frontend/src/axiosInstance.js"],"sourcesContent":["import axios from 'axios';\n\nconst axiosInstance = axios.create({\n    baseURL: 'http://localhost:8000/api/',\n    timeout: 5000,\n});\n\naxiosInstance.interceptors.request.use(\n    (config) => {\n        const accessToken = localStorage.getItem('access_token');\n        if (accessToken) {\n            config.headers['Authorization'] = 'Bearer ' + accessToken;\n        }\n        return config;\n    },\n    (error) => {\n        return Promise.reject(error);\n    }\n);\n\naxiosInstance.interceptors.response.use(\n    (response) => response,\n    async (error) => {\n        const originalRequest = error.config;\n\n        if (error.response.status === 401 && originalRequest.url === 'token/refresh/') {\n            window.location.href = '/login';\n            return Promise.reject(error);\n        }\n\n        if (error.response.status === 401 && !originalRequest._retry) {\n            originalRequest._retry = true;\n            const refreshToken = localStorage.getItem('refresh_token');\n\n            if (refreshToken) {\n                try {\n                    const response = await axios.post('http://localhost:8000/api/token/refresh/', { refresh: refreshToken });\n                    localStorage.setItem('access_token', response.data.access);\n                    axios.defaults.headers['Authorization'] = 'Bearer ' + response.data.access;\n                    return axiosInstance(originalRequest);\n                } catch (err) {\n                    console.error(\"Token refresh failed\", err);\n                    window.location.href = '/login';\n                }\n            }\n        }\n        return Promise.reject(error);\n    }\n);\n\nexport default axiosInstance;"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,MAAMC,aAAa,GAAGD,KAAK,CAACE,MAAM,CAAC;EAC/BC,OAAO,EAAE,4BAA4B;EACrCC,OAAO,EAAE;AACb,CAAC,CAAC;AAEFH,aAAa,CAACI,YAAY,CAACC,OAAO,CAACC,GAAG,CACjCC,MAAM,IAAK;EACR,MAAMC,WAAW,GAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC;EACxD,IAAIF,WAAW,EAAE;IACbD,MAAM,CAACI,OAAO,CAAC,eAAe,CAAC,GAAG,SAAS,GAAGH,WAAW;EAC7D;EACA,OAAOD,MAAM;AACjB,CAAC,EACAK,KAAK,IAAK;EACP,OAAOC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAChC,CACJ,CAAC;AAEDZ,aAAa,CAACI,YAAY,CAACW,QAAQ,CAACT,GAAG,CAClCS,QAAQ,IAAKA,QAAQ,EACtB,MAAOH,KAAK,IAAK;EACb,MAAMI,eAAe,GAAGJ,KAAK,CAACL,MAAM;EAEpC,IAAIK,KAAK,CAACG,QAAQ,CAACE,MAAM,KAAK,GAAG,IAAID,eAAe,CAACE,GAAG,KAAK,gBAAgB,EAAE;IAC3EC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;IAC/B,OAAOR,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;EAChC;EAEA,IAAIA,KAAK,CAACG,QAAQ,CAACE,MAAM,KAAK,GAAG,IAAI,CAACD,eAAe,CAACM,MAAM,EAAE;IAC1DN,eAAe,CAACM,MAAM,GAAG,IAAI;IAC7B,MAAMC,YAAY,GAAGd,YAAY,CAACC,OAAO,CAAC,eAAe,CAAC;IAE1D,IAAIa,YAAY,EAAE;MACd,IAAI;QACA,MAAMR,QAAQ,GAAG,MAAMhB,KAAK,CAACyB,IAAI,CAAC,0CAA0C,EAAE;UAAEC,OAAO,EAAEF;QAAa,CAAC,CAAC;QACxGd,YAAY,CAACiB,OAAO,CAAC,cAAc,EAAEX,QAAQ,CAACY,IAAI,CAACC,MAAM,CAAC;QAC1D7B,KAAK,CAAC8B,QAAQ,CAAClB,OAAO,CAAC,eAAe,CAAC,GAAG,SAAS,GAAGI,QAAQ,CAACY,IAAI,CAACC,MAAM;QAC1E,OAAO5B,aAAa,CAACgB,eAAe,CAAC;MACzC,CAAC,CAAC,OAAOc,GAAG,EAAE;QACVC,OAAO,CAACnB,KAAK,CAAC,sBAAsB,EAAEkB,GAAG,CAAC;QAC1CX,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;MACnC;IACJ;EACJ;EACA,OAAOR,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAChC,CACJ,CAAC;AAED,eAAeZ,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}